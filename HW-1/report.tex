\documentclass[a4paper,12pt]{article}

% Packages
\usepackage[T1]{fontenc}     % Font encoding
\usepackage{lmodern}         % Modern font
\usepackage{geometry}        % Page layout
\geometry{margin=1in}        % 1-inch margins
\usepackage{amsmath, amssymb} % Math symbols
\usepackage{booktabs}        % Better tables
\usepackage{graphicx}       % Include graphics

% Title Page
\title{\textbf{Report HW1}}

\author{
    \begin{tabular}{cc}
        Simone De Carli & Damiano Salvaterra \\
        {\small \texttt{simone.decarli@studenti.unitn.it}} & {\small \texttt{damiano.salvaterra@studenti.unitn.it}}
    \end{tabular}
}


\begin{document}

\maketitle

\newcommand{\E}[1]{\operatorname{E}\left[#1\right]}
\newcommand{\Var}[1]{\operatorname{Var}\left[#1\right]}

\section*{Introduction}

We conducted the following exercises with $10^7$ samples for each experiment.

We also used 5 different RNGs: (\texttt{MT19937}, \texttt{PCG64}, \texttt{PCG64DXSM}, \texttt{Philox}, \texttt{SFC64}) provided from the \texttt{numpy} library.


\section*{Exercise 1}

Gaussians parameters:\\

\begin{tabular}{c|cc|c}
    \hline
    \textbf{NÂ°} & \textbf{Mean} & \textbf{Variance} & \textbf{Probability} \\
    \hline
    1 & -2 & 2 & 0.15 \\
    2 & 4 & 1 & 0.25 \\
    3 & 10 & 3 & 0.35 \\
    4 & 15 & 2 & 0.25 \\
    \hline
\end{tabular}\\

\noindent
Let $X$ be the random variable representing the drawn number from one of the four Gaussians. Let $Y$ be the random variable representing the Gaussian from which the number is drawn.\\

The expectation of $X$ can be calculated as follows:
\begin{equation*}
\begin{split}
\E{X} & = \E{X|Y=1}P(Y=1) + \E{X|Y=2}P(Y=2)\\
& + \E{X|Y=3}P(Y=3) + \E{X|Y=4}P(Y=4) \\
& = 7.95
\end{split}
\end{equation*}

The variance of $X$ can be calculated as follows:
\begin{equation*}
\begin{split}
\Var{X} & = \E{\Var{X|Y}} + \Var{\E{X|Y}} \\
& = \sigma^2_1 \cdot P(Y=1) + \sigma^2_2 \cdot P(Y=2) + \sigma^2_3 \cdot P(Y=3) + \sigma^2_4 \cdot P(Y=4) \\
& + \E{\E{X|Y}^2} - \E{X}^2 \\
& = 34.7475
\end{split}
\end{equation*}

\begin{figure}[h]
    \includegraphics[width=0.6\textwidth]{ex1-plot.png}
\end{figure}

\section*{Exercise 2}

Let $X \sim \operatorname{Exp}(\lambda)$ and $Y \sim U(a,b)$. We wish to calculate the probability:
\[
P(X > Y).
\]

Since $X$ and $Y$ are independent, we can write:
\[
P(X > Y) = \int_a^b P(X > y \mid Y = y) f_Y(y) \, dy,
\]
where $f_Y(y)$ is the density of the uniform distribution on $[a,b]$:
\[
f_Y(y) = \frac{1}{b-a}, \quad \text{for } y \in [a,b].
\]

For an exponential random variable $X$ with parameter $\lambda$, the survival function is:
\[
P(X > y) = \int_y^\infty \lambda e^{-\lambda x} \, dx = e^{-\lambda y}, \quad \text{for } y \ge 0.
\]

Substituting the expression for $P(X > y)$ into the integral:
\[
P(X > Y) = \frac{1}{b-a} \int_a^b e^{-\lambda y} \, dy.
\]
We compute the integral:
\[
\int_a^b e^{-\lambda y} \, dy = \left[ -\frac{1}{\lambda} e^{-\lambda y} \right]_a^b = \frac{1}{\lambda}\left(e^{-\lambda a} - e^{-\lambda b}\right).
\]
We finally obtain:
\[
P(X > Y) = \frac{1}{b-a} \cdot \frac{e^{-\lambda a} - e^{-\lambda b}}{\lambda} = \frac{e^{-\lambda a} - e^{-\lambda b}}{\lambda (b-a)}.
\]
Thus, the final expression is:
\[
\boxed{P(X > Y) = \frac{e^{-\lambda a} - e^{-\lambda b}}{\lambda (b-a)}.}
\]

Setting $\lambda=1$, $a=0$, and $b=5$, we have:
\[
P(X > Y) = \frac{e^{-1\cdot 0} - e^{-1\cdot 5}}{1\cdot (5-0)} = \frac{1 - e^{-5}}{5} \approx 0.1987.
\]

\begin{figure}[h]
    \includegraphics[width=0.6\textwidth]{ex2-plot.png}
\end{figure}


\end{document}
